---
layout: post
title: "Tweaks to the knitr + pandoc Generated .tex to Finalize Formatting"
---

## Problems

I just finished submitting the first article to a journal that I wrote with Rmarkdown + knitr + pandoc in RStudio. Using this workflow has two purposes: 1) maintian reproducibility and 2) remove formatting effort. 

It is true that while developing the working paper Rmarkdown + knitr + pandoc produced a very nice looking PDF for the working paper. However, I couldn't really finalize the document for sumbission; I had to manually edit some things in the `keep_tex: true` file. 

I was surprized because I expected this to be seamless. I submitted to an Elsevier journal, and the `rticles` package contains an Elsevier articles template that I assumed would whip up a fully formatted Elsevier just like in the class documentation. 

It didn't really work that way. I think the default latex .csl file that pandoc uses was interfering or overriding the `elsarticle.csl` file that `rticles` was pulling in. The format was not the default, but it certainly was not formatted for Elsevier. 

Another issue I had was adding notes to my tables and figures. As far as I can tell, there is no way to add a note to the bottom of tables and figures in the [chunk options](http://yihui.name/knitr/options/). Maybe I am missing something. 

## Solutions

So, the solutions I came up with to these problems are: 

1. Open the `elsarticle` example .tex document and replacing everything including and after `\title{}` in the example document with everything including and after `\title{}` in my .tex document generated by pandoc. Then I added any packages to the .tex preamble that I had specified in the `header-includes:` portion of the YAML header. 

2. I added the `{\footnotesize   }` container to the figure environment just after the `\includegraphics`. Example:

```
\begin{figure}[htbp]
\includegraphics[scale=0.95]{path/to/chunk/unnamed-chunk-4-1.pdf}
{\footnotesize  \emph{Notes:} Footnote for figure \par}
\caption{This is really the title of the figure}
\end{figure}

```

Once I made those changes I could generate a pdf that was fully formatted for Elsevier. 


